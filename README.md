# devopsdeflope.ru

## Локальная работа

* `docker build -t deflope .`
* `decker run --rm --it --mount src=`pwd`,dst=/app,type=bind -p 4567:4567 deflope`

## Как добавить новый выпуск

- [ ] Добавить в `source/posts/<год>/` файл с описанием.
- [ ] Название файла с описанием в формате `<год>-<месяц>-<день>-<номер эпизода>.html.markdown`
- [ ] Добавить в `source/mp3/` запись выпуска. Название файла в формате: `deflope<номер выпуска>.mp3`. **Номер выпуска в названии mp3 и номер выпуска в файле с описанием должны совпадать!**
- [ ] Установить зависимости `bundle install --path vendor/bundle`
- [ ] Собрать сайт `bundle exec middleman build`
- [ ] Запустить сайт и убедиться, что все выглядит правильно. `bundle exec middleman server`
- [ ] **Убедится, что aws ключ от s3 лежит в файле `.s3_sync`, в противном случае деплой будет долго висеть, возможно, упадет с трейсом, но не напишет о проблемах с кредами**
- [ ] Задеплоить сайт `bundle exec middleman s3_sync`
- [ ] Загрузить запись выпуска на gdrive
